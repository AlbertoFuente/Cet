function showGraphModal(e,t,a){var n=document.createElement("div");n.className="gModal";var o=document.createElement("div");o.className="gHeader";var l=document.createElement("button");l.className="closeButton mdi-content-clear",l.onclick=function(){closeModal(n)};var r=document.createElement("div");r.className="gContent",r.id="chart";var i=document.createElement("svg");switch(r.appendChild(i),o.appendChild(l),n.appendChild(o),n.appendChild(r),e){case"Bar chart":var s=[];s.push({key:"Table Bar Chart",values:[]}),$.each(t,function(e){s[0].values.push({label:t[e],value:parseInt(a[e])})}),nv.addGraph(function(){var e=nv.models.discreteBarChart().x(function(e){return e.label}).y(function(e){return e.value}).staggerLabels(!0).tooltips(!0).showValues(!0).duration(250);return d3.select("#chart svg").datum(s).call(e),nv.utils.windowResize(e.update),e});break;case"Line chart":var c=[];c.push({key:"Line Chart",values:[]}),$.each(t,function(e){c[0].values.push({area:!1,label:t[e],value:parseInt(a[e])})}),nv.addGraph(function(){var e=nv.models.lineWithFocusChart();return e.xAxis.tickFormat(d3.format(",f")),e.x2Axis.tickFormat(d3.format(",f")),e.yAxis.tickFormat(d3.format(",.2f")),e.y2Axis.tickFormat(d3.format(",.2f")),d3.select("#chart svg").datum(c).call(e),nv.utils.windowResize(e.update),e});break;case"Pie chart":var d=[];$.each(t,function(e){d.push({label:t[e],value:parseInt(a[e])})}),nv.addGraph(function(){var e=nv.models.pieChart().x(function(e){return e.label}).y(function(e){return e.value}).showLabels(!0).labelThreshold(.05).labelType("percent").donut(!0).donutRatio(.35);return d3.select("#chart svg").datum(d).transition().duration(350).call(e),e});break;case"Scatter chart":var u=[];u.push({key:"Scatter Chart",values:[]}),$.each(t,function(e){u[0].values.push({label:t[e],value:parseInt(a[e])})}),nv.addGraph(function(){var e=nv.models.scatterChart().showDistX(!0).showDistY(!0).useVoronoi(!0).color(d3.scale.category10().range()).duration(300);return e.xAxis.tickFormat(d3.format(".02f")),e.yAxis.tickFormat(d3.format(".02f")),e.tooltipContent(function(e){return"<h2>"+e+"</h2>"}),d3.select("#chart svg").datum(u).call(e),nv.utils.windowResize(e.update),e})}document.body.appendChild(n)}function prepareGraphData(e,t,a){function n(e){var t=document.createElement("label");t.className="errLabel",t.innerHTML="Impossible to construct a graph of the selected data, try another selection.",e.appendChild(t),setTimeout(function(){e.removeChild(t)},5e3)}var o=t.type,l=t.xAxis,r=t.yAxis,i=e.tableData[0].head,s=e.tableData[0].body,c=null,d=null,u=[],p=[],m={};$.each(i,function(e,t){t===l&&(c=e.slice(-1)),t===r&&(d=e.slice(-1))}),$.each(s,function(e,t){$.each(t,function(e,t){var a="td"+c,n="td"+d;a===e&&u.push(t.data),n===e&&p.push(t.data)})}),u.length>0&&u.length===p.length&&(m.sameLength=!0);var h=0,v=0,f=/^\d+$/;for(h;h<u.length;h++){if(!f.test(u[h])){m.xAxisIsNum=!1;break}m.xAxisIsNum=!0}for(v;v<p.length;v++){if(!f.test(p[v])){m.yAxisIsNum=!1;break}m.yAxisIsNum=!0}m.sameLength&&(m.xAxisIsNum!==m.yAxisIsNum?(a.parentNode.style.display="none",showGraphModal(o,u,p)):n(a))}function closeModal(e){$(e).remove()}function openModal(e,t){function a(e,t,a,n,o){var l=document.createElement("label");l.innerHTML=e,a.appendChild(l);var r=0;for(o.id=n,r;r<t.length;r++){var i=document.createElement("option");i.value=t[r],i.innerHTML=t[r],o.appendChild(i)}a.appendChild(o)}var n=document.createElement("div");n.id="_cetTableModal";var o=document.createElement("div");o.className="_cetTableModalHeader";var l=document.createElement("label"),r=document.createElement("button");r.className="closeButton mdi-content-clear",r.onclick=function(){closeModal(n)};var i=document.createElement("div");switch(i.className="_cetTableContent",e){case"graph":l.innerHTML="Config graph options";var s="Select graph type: ",c=document.createElement("select"),d="selectType",u=["Bar chart","Line chart","Pie chart","Scatter chart"];a(s,u,i,d,c);var p="Select X axis: ",m=document.createElement("select"),h="selectXaxis",v=[],f=t.tableData[0].head;$.each(f,function(e,t){v.push(t)}),a(p,v,i,h,m);var b="Select Y axis: ",g=document.createElement("select"),y="selectYaxis",N=[];$.each(f,function(e,t){N.push(t)}),a(b,N,i,y,g);var C=document.createElement("a");C.className="doneButton waves-effect waves-light btn",C.innerHTML="DONE",i.appendChild(C),C.onclick=function(){var e={};e.xAxis=m.value,e.yAxis=g.value,e.type=c.value,prepareGraphData(t,e,i)}}o.appendChild(r),o.appendChild(l),n.appendChild(o),n.appendChild(i),document.body.appendChild(n)}function closeMenu(e,t){e.style.display="none";var a=t.childNodes[0];a.className="normalButton mdi-navigation-menu"}function listTableOptions(e,t,a){function n(n,o,l){var r=document.createElement("li");r.className="optionsLi",r.innerHTML=o,l.appendChild(r),r.onclick=function(){openModal(n,e),closeMenu(t,a)}}var o=document.createElement("ul");o.className="optionsList";var l=null,r=null;e.listOptions.graphs&&(l="graph",r="Show graph panel",n(l,r,o)),e.listOptions.downloads&&(l="downloads",r="Show Downloads Panel",n(l,r,o)),t.appendChild(o)}function getLocalData(e,t){void 0!==e&&(localStorage.getItem("_tableData")?(e.tableData=JSON.parse(localStorage.getItem("_tableData")),t.tableConstructor(e)):$.ajax({url:e.localDataUrl,method:"GET",dataType:"json",success:function(a){void 0!==a&&(e.tableData=a,t.tableConstructor(e))},error:function(){throw new Error("Could not load the data inside the "+e.localDataUrl+" file")}}))}function fireBaseData(e,t){if(void 0!==e){var a=new Firebase(e.fireBaseUrl);a.on("value",function(a){e.tableData=a.val(),t.tableConstructor(e)},function(e){throw new Error("The read failed: "+e.code)})}}function apiRestData(){}function createTable(e){var t=this;this.modifyData=function(t,a,n,o){switch(e.tableData[0].body[t][a].data=n,o){case 1:if(!window.localStorage)throw new Error("Your browser don't support LocalStorage!");localStorage.setItem("_tableData",JSON.stringify(e.tableData));break;case 2:if(""!==e.fireBaseUrl){var l=new Firebase(e.fireBaseUrl);l.set(e.tableData)}break;case 3:}},this.printNewBody=function(e,t,a){var n=a.childNodes[1],o=[],l=0;for($(n).empty(),l;l<e.length;l++)for(var r=0;r<t.length;r++)e[l]===t[r].value&&o.push(t[r].tr);$(n).append(o)},this.mouseEffects=function(e,t){var a=e.parentNode.parentNode.className,n=e.parentNode.className;tableEffects(a,n,t)},this.inputChange=function(a){var n=a.parentNode.className,o=a.value,l=a.parentNode.parentNode.className;t.modifyData(l,n,o,e.mode)},this.tableConstructor=function(e){if(void 0!==e){if(e.header){var a=document.createElement("div");a.className="tableHeader";var n=document.createElement("label");if(n.className="tableHeaderTitle",n.innerHTML=e.title,e.options){var o=document.createElement("button");o.className="normalButton mdi-navigation-menu",a.appendChild(o);var l=document.createElement("div");l.className="optionsContainer",l.style.display="none",void 0!==e.listOptions&&"object"==typeof e.listOptions&&listTableOptions(e,l,a),o.onclick=function(){var e=this.getBoundingClientRect();l.style.top=e.top+38+"px",l.style.left=e.left-164+"px","normalButton mdi-navigation-menu"===this.className?(this.className="clickedButton mdi-navigation-menu",$(document).find("optionsContainer")?(document.body.appendChild(l),l.style.display="block"):l.style.display="block"):(this.className="normalButton mdi-navigation-menu",l.style.display="none")}}a.appendChild(n),e.container.appendChild(a)}if(1===e.container.childNodes.length){var r=document.createElement("table");r.id="cetTable",r.className="striped";var i=document.createElement("tHead"),s=e.tableData.head||e.tableData[0].head;$.each(s,function(t,a){var n=document.createElement("th");if(n.className=t,n.innerHTML=a,n.setAttribute("data-field",a),e.sortable){var o=document.createElement("i");o.className="mdi-hardware-keyboard-arrow-down sortIcon",n.appendChild(o)}i.appendChild(n)}),r.appendChild(i);var c=document.createElement("tBody"),d=e.tableData.body||e.tableData[0].body;$.each(d,function(e,t){var a=document.createElement("tr");a.className=e,$.each(t,function(e,t){var n=document.createElement("td");if(n.className=e,void 0!==t.data&&void 0!==t.type){var o=document.createElement("input");o.className="input_"+e,"date"===t.type?($(o).addClass("datepicker picker__input"),o.type="text",o.value=t.data,o.setAttribute("placeholder",t.data)):(o.type=t.type,o.value=t.data),t.edit||o.setAttribute("disabled","disabled"),n.appendChild(o)}a.appendChild(n)}),c.appendChild(a)}),r.appendChild(c),e.container.appendChild(r);var u=r.getElementsByTagName("input"),p=r.getElementsByTagName("i");return $(u).change(function(){t.inputChange(this)}),$(u).hover(function(){t.mouseEffects(this,"hover")}),$(u).mouseout(function(){t.mouseEffects(this,"out")}),$(p).click(function(){var e=this.parentNode.className,a=e.slice(-1),n="td"+a,o="sort",l="mdi-hardware-keyboard-arrow-down sortIcon",i="mdi-hardware-keyboard-arrow-up sortIcon",s=r.getElementsByTagName("i"),c=0,d="down";if(this.className===l)for(c;c<s.length;c++)s[c].className=i,d="up";else for(c;c<s.length;c++)s[c].className=l,d="down";tableEffects(e,n,o,r,d,t)}),$(".datepicker").pickadate(),e.container}return!1}},void 0!==e&&(e.dataOptions.localData?""!==e.localDataUrl?(e.mode=1,getLocalData(e,t)):alert("You must add _cetTable.localDataUrl in config.js"):e.dataOptions.fireBase?""!==e.fireBaseUrl?(e.mode=2,fireBaseData(e,t)):alert("You must add _cetTable.fireBaseUrl in config.js"):e.dataOptions.apiRest&&(""!==e.apiRestUrl?(e.mode=3,apiRestData(e.apiRestUrl)):alert("You must add _cetTable.apiRestUrl in config.js")))}function tableEffects(e,t,a,n,o,l){var r=$("."+e),i=$("."+t),s=t.slice(-1),c=$(".th"+s);switch(a){case"hover":r.attr("style","background: rgba(15, 151, 249, 0.21)"),i.attr("style","background: rgba(15, 151, 249, 0.21)"),c.attr("style","background: rgb(15, 151, 249); color: white");break;case"out":r.removeAttr("style"),i.removeAttr("style"),c.removeAttr("style");break;case"sort":var d=n.getElementsByClassName(t),u=0,p=[],m=[],h=/^\d+$/,v=!1;for(u;u<d.length;u++)v=!!h.test(d[u].childNodes[0].value),p.push({tr:d[u].parentNode,value:d[u].childNodes[0].value}),m.push(d[u].childNodes[0].value);"down"===o?(v?m.sort(function(e,t){return e-t}):m.reverse(),l.printNewBody(m,p,n)):(v?m.sort(function(e,t){return t-e}):m.sort(),l.printNewBody(m,p,n));var f=n.getElementsByTagName("input");$(f).change(function(){l.inputChange(this)}),$(f).hover(function(){l.mouseEffects(this,"hover")}),$(f).mouseout(function(){l.mouseEffects(this,"out")}),$(".datepicker").pickadate()}}var imported=document.createElement("script");imported.src="../config/config.js",document.head.appendChild(imported);